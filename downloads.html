<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Official IGSTC Workshop 2025 - A professional conference for experts.">
    <meta name="robots" content="index, follow">
    <meta name="author" content="IGSTC Conference Team">
    <meta name="keywords" content="IGSTC, Workshop 2025, AI, Sustainability, Networking">

    <title>PPTs & Photos | IGSTC Bi-Lateral Workshop 2025</title>

    <!-- External Styles -->
    <link rel="stylesheet" href="assets/css/header.css">
    <link rel="stylesheet" href="assets/css/footer.css">
    <link rel="stylesheet" href="assets/css/downloads.css">
</head>

<body>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <a href="https://iisc.ac.in/" target="_blank"><img src="assets/logo/IISC_logo.png" alt="IISc"></a>
            <a href="index.html"><img src="assets/logo/IGSTC_logo.png" alt="IGSTC"></a>
            <a href="https://www.uni-koeln.de/en/" target="_blank"><img src="assets/logo/universityofcologne.png" alt="University Of Cologne"></a>
        </div>
        <nav class="header-right">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="speakers.html">Speakers</a></li>
                <li><a href="invitees.html">Invitees</a></li>
                <li><a href="agenda.html">Agenda</a></li>
                <li><a href="venue.html">Venue</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="downloads.html" class="active">PPTs & Photos</a></li>
            </ul>
        </nav>
    </header>

   <!-- Page Title -->
   <h2>Download Conference Files</h2>

   <!-- PPT Downloads Section -->
   <br><h4>Download Speaker PPTs</h4>
   <div id="ppts-container" class="grid-container"></div>

   <!-- Photos Download Section -->
   <h4>Download Event Photos</h4>
   <br><a target="_blank" href="https://your-onedrive-link.com" class="download-btn">Download Photos</a>

   <br><h4>Field Trip Photos</h4>

   <!-- Image Carousel -->
   <div class="carousel-container">
       <div class="carousel" id="photo-carousel"></div>
       <button class="carousel-btn prev" onclick="changeSlide(-1)">❮</button>
       <button class="carousel-btn next" onclick="changeSlide(1)">❯</button>
   </div>

   <!-- Lightbox for Enlarged Image -->
   <div id="lightbox" class="lightbox">
       <div class="lightbox-header">
           <a id="download-btn" href="#" download class="download-lightbox">Download</a>
           <span class="close-lightbox" onclick="closeLightbox()">✖</span>
       </div>
       <button class="lightbox-nav prev" onclick="changeLightboxSlide(-1)">❮</button>
       <img id="lightbox-image" src="" alt="Full Image">
       <button class="lightbox-nav next" onclick="changeLightboxSlide(1)">❯</button>
   </div>

   <!-- JavaScript -->
   <script>
       let photosList = [];
       let currentIndex = 0;
       let carouselIndex = 0;
       let carouselInterval;

       async function fetchDownloads() {
           try {
               // ✅ Fetch PPTs
               const pptResponse = await fetch("https://igstc-backend.onrender.com/api/downloads/ppts/");
               if (!pptResponse.ok) throw new Error("Failed to fetch PPTs");

               const pptData = await pptResponse.json();
               const pptContainer = document.getElementById("ppts-container");

               if (!pptData.ppts || pptData.ppts.length === 0) {
                   pptContainer.innerHTML = "<p>No PPTs available for download.</p>";
               } else {
                   pptData.ppts.forEach(ppt => {
                       const div = document.createElement("div");
                       div.className = "ppt-item";

                       const a = document.createElement("a");
                       a.href = ppt.url;
                       a.textContent = ppt.name;
                       a.download = ppt.name;

                       div.appendChild(a);
                       pptContainer.appendChild(div);
                   });
               }

               // ✅ Fetch Field Trip Photos from S3
               const photoResponse = await fetch("https://igstc-backend.onrender.com/api/downloads/field-trip-photos/");
               if (!photoResponse.ok) throw new Error("Failed to fetch photos");

               const photoData = await photoResponse.json();
               const photoContainer = document.getElementById("photo-carousel");

               if (!photoData.photos || photoData.photos.length === 0) {
                   photoContainer.innerHTML = "<p>No Field Trip Photos available.</p>";
               } else {
                   photosList = photoData.photos;
                   photoContainer.innerHTML = ""; // Clear previous images

                   photoData.photos.forEach((photo, index) => {
                       const img = document.createElement("img");
                       img.src = photo.url;
                       img.className = "carousel-image";
                       img.alt = `Field Trip Photo ${index + 1}`;
                       img.setAttribute("data-index", index);

                       // Open Lightbox When Clicked
                       img.addEventListener("click", function () {
                           openLightbox(photo.url, index);
                       });

                       photoContainer.appendChild(img);
                   });

                   startCarousel();
               }
           } catch (error) {
               console.error("❌ Error:", error);
               document.getElementById("ppts-container").innerHTML = "<p>Error loading PPTs. Please try again later.</p>";
           }
       }

       // ✅ Start Auto Carousel
       function startCarousel() {
           const carousel = document.getElementById("photo-carousel");
           carouselInterval = setInterval(() => {
               if (photosList.length > 1) {
                   carouselIndex = (carouselIndex + 1) % photosList.length;
                   carousel.style.transform = `translateX(-${carouselIndex * 100}%)`;
               }
           }, 3000); // Move every 3 seconds
       }

       // ✅ Open Lightbox
       function openLightbox(src, index) {
           clearInterval(carouselInterval);
           currentIndex = index;
           document.getElementById("lightbox").style.display = "flex";
           document.getElementById("lightbox-image").src = src;
           document.getElementById("download-btn").href = src;
           document.getElementById("download-btn").setAttribute("download", `FieldTripPhoto${index + 1}.jpg`);
       }

       // ✅ Close Lightbox
       function closeLightbox() {
           document.getElementById("lightbox").style.display = "none";
           startCarousel();
       }

       // ✅ Change Lightbox Slide
       function changeLightboxSlide(direction) {
           currentIndex += direction;
           if (currentIndex < 0) currentIndex = photosList.length - 1;
           else if (currentIndex >= photosList.length) currentIndex = 0;

           document.getElementById("lightbox-image").src = photosList[currentIndex].url;
       }

       // ✅ Fetch and Display Files on Page Load
       fetchDownloads();
   </script>

   <footer>
       <p>&copy; 2025 IGSTC Conference | All rights reserved.</p>
   </footer>
</body>
</html>
